<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - interstellar2.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Fri, 22 Aug 2025 12:56:14
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># TODO: add RK4</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># TODO: find out the Schwarzchild radius and test if it still breaks the code</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># TODO: optimize rest of the code - RK4</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># TODO: make the disc more colorful</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using LinearAlgebra</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using Colors</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using FileIO</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using ImageIO</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using Parameters</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>include&#40;&quot;algebra.jl&quot;&#41; </span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Parameters </span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># image size </span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const W &#61; 200 # horizontal resolution</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const H &#61; 200 # vertical resolution </span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># camera</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const camera_position &#61; RealVector&#40;1.0, 0.3, 4.0&#41; # camera position in space</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># field of view</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const fov &#61; Ï€/3 </span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const look_at &#61; RealVector&#40;0.0, 0.0, 0.0&#41; # point the camera is looking at </span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const world_up &#61; RealVector&#40;1.0, 0.0, 0.0&#41; # world up vector </span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># positions &amp; physics </span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const M &#61; 0.1 #44.0 # mass of the black hole sphere and disc</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const sphere_position &#61; RealVector&#40;0.0, 0.0, 0.0&#41; # center of the sphere </span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const sphere_radius &#61; 9*M # radius of the sphere </span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const second_sphere_position &#61; RealVector&#40;0.0, 0.0, -555.0&#41;</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const second_sphere_radius &#61; 3.0 </span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const third_sphere_position &#61; RealVector&#40;1.0, 1.0, -553.0&#41;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const third_sphere_radius &#61; 0.9</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const Rin &#61; 0.1 # inner radius of the disc </span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const Rout &#61; 2.0 # outer radius of the disc </span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># camera basics </span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const F &#61; normalize&#40;look_at - camera_position&#41; # where the camera is looking at </span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const R &#61; normalize&#40;cross&#40;F,world_up&#41;&#41; # horizontal axis of the camera</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const U &#61; normalize&#40;cross&#40;F,R&#41;&#41; # vertical axis of the camera -- note that U should be already normalized, we do it for convenience</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const aspect_ratio &#61; W / H # aspect ration </span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>const scale &#61; tan&#40;fov / 2&#41; </span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#Structs </span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@with_kw mutable struct Ray</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    position::Real4Vector</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    velocity::Real4Vector</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    pixel::Tuple&#123;Int, Int&#125; # pixel coordinates of the ray</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    color::RGB&#123;Float64&#125; &#61; RGB&#40;0.0, 0.0, 0.0&#41; # default color is black</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    flag::Bool &#61; true # flag to indicate if the ray is active or not</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #isActive::Bool &#61; true # flag to indicate if the ray is active or not</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#Functions </span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function map_pixel&#40;x::Int, N::Int&#41;::Float64</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return &#40;&#40;x - 0.5&#41; / N - 0.5&#41; * 2.0</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function f&#40;r::Float64&#41;::Float64</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return 1 - 2 * M / r </span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>302 &#40;1 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              302 &#40;1 &#37;&#41;
              samples spent in f
              <br />
              
              302 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from schwarzschild_rhs
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L238'>line 238</a>
              <br />
            </div>
            <div class='callees'>
              219 &#40;73 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L494'>/</a>
              <br />
              83 &#40;27 &#37;&#41;
              samples spent calling
              <a href='promotion.jl-4d777ef2dd291b72010bfae75f5754793732cf8f.html#L431'>-</a>
              <br />
            </div>
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function to4Vector&#40;x::RealVector, a::Float64&#41;::Real4Vector</span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Convert a RealVector to a Real4Vector by appending zero</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return Real4Vector&#40;x&#91;1&#93;, x&#91;2&#93;, x&#91;3&#93;, a&#41;</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function return_index&#40;i::Int, j::Int, W::Int, H::Int&#41;::Int </span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # This function return the index of the ray in the rays array </span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return &#40;j - 1&#41; * W &#43; i </span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function sph_basis&#40;r::Float64, theta::Float64, phi::Float64&#41;</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    er  &#61; RealVector&#40;cos&#40;phi&#41;*sin&#40;theta&#41;,      cos&#40;theta&#41;, sin&#40;phi&#41;*sin&#40;theta&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    etheta  &#61; RealVector&#40;cos&#40;phi&#41;*cos&#40;theta&#41;, -sin&#40;theta&#41;, cos&#40;theta&#41;*sin&#40;phi&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ephi  &#61; RealVector&#40;-sin&#40;phi&#41;,                     0.0,            cos&#40;phi&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return er, etheta, ephi</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function dir_to_sph_rates&#40;dir::RealVector, r::Float64, theta::Float64, phi::Float64&#41;::RealVector</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    er,etheta,ephi &#61; sph_basis&#40;r,theta,phi&#41;</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dr &#61; dir&#91;1&#93;*er&#91;1&#93; &#43; dir&#91;2&#93;*er&#91;2&#93; &#43; dir&#91;3&#93;*er&#91;3&#93;</span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dtheta &#61; &#40;dir&#91;1&#93;*etheta&#91;1&#93; &#43; dir&#91;2&#93;*etheta&#91;2&#93; &#43; dir&#91;3&#93;*etheta&#91;3&#93;&#41; / r</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dphi &#61; &#40;dir&#91;1&#93;*ephi&#91;1&#93; &#43; dir&#91;2&#93;*ephi&#91;2&#93; &#43; dir&#91;3&#93;*ephi&#91;3&#93;&#41; / &#40;r*sin&#40;theta&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return RealVector&#40;dr, dtheta, dphi&#41;</span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function make_system&#33;&#40;rays::Vector&#123;Ray&#125;, W::Int, H::Int&#41;::Vector&#123;Ray&#125;</span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # This function creates array of rays with initial positions and velocities</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # that are moving away from the camera position. </span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # using Threads in this place is not a great improvement, however if one should run </span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # interactive simulation where make_system is called multiple times, this will save a</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # lot of time </span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @inbounds Threads.@threads for j in 1:H</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        @inbounds @simd for i in 1:W </span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            u &#61; map_pixel&#40;i, W&#41;</span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            v &#61; map_pixel&#40;j, H&#41;</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # apply FOV scaling </span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            px &#61; u * aspect_ratio * scale</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            py &#61; -v * scale # minus sign so that the y-axis points up</span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # ray direction </span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            cam_buffer &#61; cartesian_to_spherical&#40;camera_position&#41;</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            pos &#61; to4Vector&#40;cam_buffer, 0.0&#41; </span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            D &#61; normalize&#40;F &#43; px*R &#43; py*U&#41;</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            D &#61; dir_to_sph_rates&#40;D, cam_buffer&#91;1&#93;, cam_buffer&#91;2&#93;, cam_buffer&#91;3&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dr &#61; D&#91;1&#93; </span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dtheta &#61; D&#91;2&#93; </span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dphi &#61; D&#91;3&#93;</span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            r &#61; pos&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            theta &#61; pos&#91;2&#93;</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            fr &#61; f&#40;r&#41;</span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dt &#61; sqrt&#40; &#40;dr^2&#41;/&#40;fr&#41;^2&#41; &#43; &#40;r^2*&#40;dtheta^2 &#43; sin&#40;theta&#41;^2 * dphi^2&#41;&#41;/fr  </span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            D_spherical &#61; to4Vector&#40;D, dt&#41; </span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1729 &#40;4 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              1729 &#40;4 &#37;&#41;
              samples spent in mod_angles&#33;
              <br />
              
              439 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L226'>line 226</a>
              <br />
              
              369 &#40;21 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L225'>line 225</a>
              <br />
              
              269 &#40;16 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L197'>line 197</a>
              <br />
              
              185 &#40;11 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L217'>line 217</a>
              <br />
              
              167 &#40;10 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L207'>line 207</a>
              <br />
              
              157 &#40;9 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L212'>line 212</a>
              <br />
              
              143 &#40;8 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L202'>line 202</a>
              <br />
            </div>
            <div class='callees'>
              1084 &#40;63 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L596'>rem</a>
              <br />
              367 &#40;21 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L595'>rem</a>
              <br />
              278 &#40;16 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L0'>rem</a>
              <br />
            </div>
            <span class='code'>             </span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3038 &#40;7 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              3038 &#40;7 &#37;&#41;
              samples spent in mod_angles&#33;
              <br />
              
              603 &#40;20 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L226'>line 226</a>
              <br />
              
              484 &#40;16 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L217'>line 217</a>
              <br />
              
              446 &#40;15 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L207'>line 207</a>
              <br />
              
              443 &#40;15 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L225'>line 225</a>
              <br />
              
              410 &#40;13 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L212'>line 212</a>
              <br />
              
              355 &#40;12 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L202'>line 202</a>
              <br />
              
              297 &#40;10 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L197'>line 197</a>
              <br />
            </div>
            <div class='callees'>
              1662 &#40;55 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L596'>rem</a>
              <br />
              802 &#40;26 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L0'>rem</a>
              <br />
              574 &#40;19 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L595'>rem</a>
              <br />
            </div>
            <span class='code'>            pix &#61; &#40;i, j&#41;</span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>44 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              44 &#40;0 &#37;&#41;
              samples spent in mod_angles&#33;
              <br />
              
              44 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L197'>line 197</a>
              <br />
            </div>
            <div class='callees'>
              44 &#40;100 &#37;&#41;
              samples spent calling
              <a href='convert.jl-2eb8bd3a64cb29db774959f7d5f04560ddea8b2c.html#L173'>StaticArray</a>
              <br />
            </div>
            <span class='code'>            ray &#61; Ray&#40;position&#61;pos, velocity&#61;D_spherical, pixel&#61;pix&#41;</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            rays&#91;return_index&#40;i, j, W, H&#41;&#93; &#61; ray</span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # rays&#91;rays_index&#93; &#61; ray</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # rays_index &#43;&#61; 1 # this will cause a racing condition if we use multiple  </span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # # one should use pixel to determine the index</span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end </span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #println&#40;&quot;Created system of rays with curved coordinates&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return rays </span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># This function moves the rays and renders the image</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function render&#40;rays::Array, t::Float64, dt::Float64 &#61; 0.01&#41;</span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>24 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              24 &#40;0 &#37;&#41;
              samples spent in macro expansion
              <br />
              
              24 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #22#threadsfor_fun#14
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L252'>line 252</a>
              <br />
            </div>
            <div class='callees'>
              24 &#40;100 &#37;&#41;
              samples spent calling
              <a href='simdloop.jl-dd03a27852bd9f947012ff0fe8e082e4d94c3031.html#L77'>macro expansion</a>
              <br />
            </div>
            <span class='code'>   for t in 0:dt:t</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # For each ray in rays array move the ray</span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # check for intersection with the sphere and the disc, if there is a collision, remove the ray from the array</span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # &#40;it needs no longer to be moved so we would be wasting time&#41;</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        Threads.@threads for k in eachindex&#40;rays&#41;</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # Move each ray only if it is still active</span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            @inbounds if rays&#91;k&#93;.flag &#61;&#61; true  </span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                #move_ray&#40;rays&#91;k&#93;, dt&#41;</span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                RK4_step&#33;&#40;rays&#91;k&#93;, dt&#41;</span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                check_for_intersection&#40;rays&#91;k&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end </span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Output image</span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    image &#61; Array&#123;RGB&#123;Float64&#125;&#125;&#40;undef, H, W&#41;</span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @inbounds Threads.@threads for k in eachindex&#40;rays&#41;</span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray &#61; rays&#91;k&#93;</span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        image&#91;ray.pixel&#91;1&#93;, ray.pixel&#91;2&#93;&#93; &#61; ray.color</span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return image</span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># This function does a single Runge-Kutta 4 step for the ray</span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>24 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              24 &#40;0 &#37;&#41;
              samples spent in macro expansion
              <br />
              
              24 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='simdloop.jl-dd03a27852bd9f947012ff0fe8e082e4d94c3031.html#L77'>line 77</a>
              <br />
            </div>
            <div class='callees'>
              24 &#40;100 &#37;&#41;
              samples spent calling
              <a href='Parameters.jl-8d7c1ddca1f4a8c9c943bc374e2f07085815b488.html#L493'>Ray</a>
              <br />
            </div>
            <span class='code'>function RK4_step&#33;&#40;ray::Ray, h::Float64&#41;</span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # TODO: implement RK4 step </span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x, v &#61; ray.position, ray.velocity</span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k1x &#61; v</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k1v &#61; schwarzschild_rhs&#40;x, v&#41;</span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k2x &#61; v &#43; 0.5h * k1v</span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k2v &#61; schwarzschild_rhs&#40;x &#43; 0.5h * k1x, v &#43; 0.5h * k1v&#41;</span>
          </td>
        </tr>
        <tr id='L160'>
          <td class='lineno'>160</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L161'>
          <td class='lineno'>161</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k3x &#61; v &#43; 0.5h * k2v</span>
          </td>
        </tr>
        <tr id='L162'>
          <td class='lineno'>162</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k3v &#61; schwarzschild_rhs&#40;x &#43; 0.5h * k2x, v &#43; 0.5h * k2v&#41;</span>
          </td>
        </tr>
        <tr id='L163'>
          <td class='lineno'>163</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              4038 &#40;9 &#37;&#41;
              samples spent in render
              <br />
              
              4038 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from main
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L388'>line 388</a>
              <br />
            </div>
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L164'>
          <td class='lineno'>164</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k4x &#61; v &#43; 0.5h * k3v</span>
          </td>
        </tr>
        <tr id='L165'>
          <td class='lineno'>165</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k4v &#61; schwarzschild_rhs&#40;x &#43; h * k3x, v &#43; h * k3v&#41;</span>
          </td>
        </tr>
        <tr id='L166'>
          <td class='lineno'>166</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L167'>
          <td class='lineno'>167</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # update position and velocity</span>
          </td>
        </tr>
        <tr id='L168'>
          <td class='lineno'>168</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4038 &#40;9 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4038 &#40;100 &#37;&#41;
              samples spent calling
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L189'>macro expansion</a>
              <br />
            </div>
            <span class='code'>    ray.position &#43;&#61; h/6 * &#40;k1x &#43; 2*k2x &#43; 2*k3x &#43; k4x&#41;</span>
          </td>
        </tr>
        <tr id='L169'>
          <td class='lineno'>169</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ray.velocity &#43;&#61; h/6 * &#40;k1v &#43; 2*k2v &#43; 2*k3v &#43; k4v&#41;</span>
          </td>
        </tr>
        <tr id='L170'>
          <td class='lineno'>170</td>
          <td class='tracecount excl'>531 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>559 &#40;1 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              559 &#40;1 &#37;&#41;
              samples spent in macro expansion
              <br />
              531 &#40;95 &#37;&#41; &#40;ex.&#41;,
              559 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #38#threadsfor_fun#17
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L252'>line 252</a>
              <br />
            </div>
            <div class='callees'>
              28 &#40;100 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-ef42e60fe9a4e70de85188c0768f6801c10fd3cc.html#L916'>getindex</a>
              <br />
            </div>
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L171'>
          <td class='lineno'>171</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L172'>
          <td class='lineno'>172</td>
          <td class='tracecount excl'>519 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>35096 &#40;75 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              35096 &#40;75 &#37;&#41;
              samples spent in macro expansion
              <br />
              519 &#40;1 &#37;&#41; &#40;ex.&#41;,
              35096 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #38#threadsfor_fun#17
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L252'>line 252</a>
              <br />
            </div>
            <div class='callees'>
              34356 &#40;99 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L192'>RK4_step&#33;</a>
              <br />
              202 &#40;1 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L230'>schwarzschild_rhs</a>
              <br />
              19 &#40;0 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L192'>RK4_step&#33;</a>
              <br />
            </div>
            <span class='code'># This function provides the right-hand side of the Schwarzschild equation </span>
          </td>
        </tr>
        <tr id='L173'>
          <td class='lineno'>173</td>
          <td class='tracecount excl'>14 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>6795 &#40;15 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              6795 &#40;15 &#37;&#41;
              samples spent in macro expansion
              <br />
              14 &#40;0 &#37;&#41; &#40;ex.&#41;,
              6795 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #38#threadsfor_fun#17
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L252'>line 252</a>
              <br />
            </div>
            <div class='callees'>
              6680 &#40;99 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L334'>check_for_intersection</a>
              <br />
              74 &#40;1 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-ef42e60fe9a4e70de85188c0768f6801c10fd3cc.html#L916'>getindex</a>
              <br />
              27 &#40;0 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L270'>spherical_to_cartesian</a>
              <br />
            </div>
            <span class='code'>function schwarzschild_rhs&#40;position::Real4Vector, velocity::Real4Vector&#41;::Real4Vector</span>
          </td>
        </tr>
        <tr id='L174'>
          <td class='lineno'>174</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r &#61; position&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L175'>
          <td class='lineno'>175</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    theta &#61; position&#91;2&#93;</span>
          </td>
        </tr>
        <tr id='L176'>
          <td class='lineno'>176</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dr &#61; velocity&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L177'>
          <td class='lineno'>177</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dtheta &#61; velocity&#91;2&#93;</span>
          </td>
        </tr>
        <tr id='L178'>
          <td class='lineno'>178</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dphi &#61; velocity&#91;3&#93;</span>
          </td>
        </tr>
        <tr id='L179'>
          <td class='lineno'>179</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dt &#61; velocity&#91;4&#93;</span>
          </td>
        </tr>
        <tr id='L180'>
          <td class='lineno'>180</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sin_theta &#61; sin&#40;theta&#41;</span>
          </td>
        </tr>
        <tr id='L181'>
          <td class='lineno'>181</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    fr &#61; f&#40;r&#41;</span>
          </td>
        </tr>
        <tr id='L182'>
          <td class='lineno'>182</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L183'>
          <td class='lineno'>183</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ddr &#61; &#40;&#40;M/r^2&#41; * &#40;dr^2/fr - fr*dt^2&#41; &#43; r*fr*&#40;dtheta^2 &#43; sin_theta^2 * dphi^2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L184'>
          <td class='lineno'>184</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ddtheta &#61; &#40;-2/r * dr*dtheta &#43; sin_theta*cos&#40;theta&#41;*dphi^2&#41;</span>
          </td>
        </tr>
        <tr id='L185'>
          <td class='lineno'>185</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ddphi &#61; &#40;-2/r * dr*dphi - 2*cot&#40;theta&#41;*dtheta*dphi&#41;</span>
          </td>
        </tr>
        <tr id='L186'>
          <td class='lineno'>186</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              1 &#40;0 &#37;&#41;
              samples spent in macro expansion
              <br />
              
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #54#threadsfor_fun#18
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L252'>line 252</a>
              <br />
            </div>
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-9351c8e3c3e31a3b8a0c690f5e177533744c07f5.html#L983'>setindex&#33;</a>
              <br />
            </div>
            <span class='code'>    ddt &#61; &#40;-2*M/&#40;r^2*fr&#41; * dt*dr&#41;   </span>
          </td>
        </tr>
        <tr id='L187'>
          <td class='lineno'>187</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return Real4Vector&#40;ddr, ddtheta, ddphi, ddt&#41; </span>
          </td>
        </tr>
        <tr id='L188'>
          <td class='lineno'>188</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L189'>
          <td class='lineno'>189</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L190'>
          <td class='lineno'>190</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function move_ray&#40;ray::Ray, h::Float64&#41;</span>
          </td>
        </tr>
        <tr id='L191'>
          <td class='lineno'>191</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Euler iteration </span>
          </td>
        </tr>
        <tr id='L192'>
          <td class='lineno'>192</td>
          <td class='tracecount excl'>130 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>130 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              34356 &#40;74 &#37;&#41;
              samples spent in RK4_step&#33;
              <br />
              196 &#40;1 &#37;&#41; &#40;ex.&#41;,
              34356 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L172'>line 172</a>
              <br />
            </div>
            
            <span class='code'>    r &#61; ray.position&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L193'>
          <td class='lineno'>193</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if r &gt; 50</span>
          </td>
        </tr>
        <tr id='L194'>
          <td class='lineno'>194</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.flag &#61; false</span>
          </td>
        </tr>
        <tr id='L195'>
          <td class='lineno'>195</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>179 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              179 &#40;100 &#37;&#41;
              samples spent calling
              <a href='Base.jl-b63de1b034843e706f34083efa09828330e9b63e.html#L49'>getproperty</a>
              <br />
            </div>
            <span class='code'>        #println&#40;&quot;Ray is too far away, stopping it&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L196'>
          <td class='lineno'>196</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return</span>
          </td>
        </tr>
        <tr id='L197'>
          <td class='lineno'>197</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>610 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              297 &#40;49 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              269 &#40;44 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
              44 &#40;7 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L114'>mod_angles&#33;</a>
              <br />
            </div>
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L198'>
          <td class='lineno'>198</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>   </span>
          </td>
        </tr>
        <tr id='L199'>
          <td class='lineno'>199</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ray.velocity &#43;&#61; h * schwarzschild_rhs&#40;ray.position, ray.velocity&#41;</span>
          </td>
        </tr>
        <tr id='L200'>
          <td class='lineno'>200</td>
          <td class='tracecount excl'>38 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>6893 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6683 &#40;97 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L230'>schwarzschild_rhs</a>
              <br />
              100 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              54 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              18 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L216'>tan</a>
              <br />
            </div>
            <span class='code'>    ray.position &#43;&#61; h * ray.velocity</span>
          </td>
        </tr>
        <tr id='L201'>
          <td class='lineno'>201</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L202'>
          <td class='lineno'>202</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>498 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              355 &#40;71 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              143 &#40;29 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
            </div>
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L203'>
          <td class='lineno'>203</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Convert spherical coordinates to cartesian coordinates for both 3D vectors</span>
          </td>
        </tr>
        <tr id='L204'>
          <td class='lineno'>204</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>279 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              179 &#40;64 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              93 &#40;33 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
              7 &#40;3 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L493'>*</a>
              <br />
            </div>
            <span class='code'>function spherical_to_cartesian&#40;position::RealVector&#41;::RealVector</span>
          </td>
        </tr>
        <tr id='L205'>
          <td class='lineno'>205</td>
          <td class='tracecount excl'>8 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>6649 &#40;14 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6459 &#40;97 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L230'>schwarzschild_rhs</a>
              <br />
              87 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              49 &#40;1 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              18 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L216'>tan</a>
              <br />
              15 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              13 &#40;0 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>    r &#61; position&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L206'>
          <td class='lineno'>206</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    theta &#61; position&#91;2&#93;</span>
          </td>
        </tr>
        <tr id='L207'>
          <td class='lineno'>207</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>613 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              446 &#40;73 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              167 &#40;27 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
            </div>
            <span class='code'>    phi &#61; position&#91;3&#93;</span>
          </td>
        </tr>
        <tr id='L208'>
          <td class='lineno'>208</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @fastmath sin_theta &#61; sin&#40;theta&#41;</span>
          </td>
        </tr>
        <tr id='L209'>
          <td class='lineno'>209</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>214 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              126 &#40;59 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              88 &#40;41 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>    @fastmath return RealVector&#40;r*cos&#40;phi&#41;*sin_theta, r*cos&#40;theta&#41;, r*sin&#40;phi&#41;*sin_theta&#41;</span>
          </td>
        </tr>
        <tr id='L210'>
          <td class='lineno'>210</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>6783 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6607 &#40;97 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L230'>schwarzschild_rhs</a>
              <br />
              86 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              50 &#40;1 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              29 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L216'>tan</a>
              <br />
              9 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              2 &#40;0 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
            </div>
            <span class='code'>end    </span>
          </td>
        </tr>
        <tr id='L211'>
          <td class='lineno'>211</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L212'>
          <td class='lineno'>212</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>567 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              410 &#40;72 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              157 &#40;28 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
            </div>
            <span class='code'># Convert spherical coordinates to cartesian coordinates for 4D vectors</span>
          </td>
        </tr>
        <tr id='L213'>
          <td class='lineno'>213</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function spherical_to_cartesian&#40;position::Real4Vector&#41;::RealVector</span>
          </td>
        </tr>
        <tr id='L214'>
          <td class='lineno'>214</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>114 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              96 &#40;84 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
              18 &#40;16 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
            </div>
            <span class='code'>    r &#61; position&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L215'>
          <td class='lineno'>215</td>
          <td class='tracecount excl'>51 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>6957 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6671 &#40;97 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L230'>schwarzschild_rhs</a>
              <br />
              89 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              86 &#40;1 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              26 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L216'>tan</a>
              <br />
              19 &#40;0 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
              15 &#40;0 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
            </div>
            <span class='code'>    theta &#61; position&#91;2&#93;</span>
          </td>
        </tr>
        <tr id='L216'>
          <td class='lineno'>216</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phi &#61; position&#91;3&#93;</span>
          </td>
        </tr>
        <tr id='L217'>
          <td class='lineno'>217</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>669 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              484 &#40;72 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              185 &#40;28 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
            </div>
            <span class='code'>    @fastmath sin_theta &#61; sin&#40;theta&#41;</span>
          </td>
        </tr>
        <tr id='L218'>
          <td class='lineno'>218</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @fastmath return RealVector&#40;r*cos&#40;phi&#41;*sin_theta, r*cos&#40;theta&#41;, r*sin&#40;phi&#41;*sin_theta&#41;</span>
          </td>
        </tr>
        <tr id='L219'>
          <td class='lineno'>219</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end   </span>
          </td>
        </tr>
        <tr id='L220'>
          <td class='lineno'>220</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L221'>
          <td class='lineno'>221</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Convert cartesian coordinates to spherical coordinates for both 3D and 4D vectors </span>
          </td>
        </tr>
        <tr id='L222'>
          <td class='lineno'>222</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>474 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              242 &#40;51 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>&#43;</a>
              <br />
              170 &#40;36 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
              45 &#40;9 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              17 &#40;4 &#37;&#41;
              samples spent calling
              <a href='promotion.jl-4d777ef2dd291b72010bfae75f5754793732cf8f.html#L432'>/</a>
              <br />
            </div>
            <span class='code'>function cartesian_to_spherical&#40;position::RealVector&#41;::RealVector</span>
          </td>
        </tr>
        <tr id='L223'>
          <td class='lineno'>223</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>661 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              317 &#40;48 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>&#43;</a>
              <br />
              216 &#40;33 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L21'>*</a>
              <br />
              73 &#40;11 &#37;&#41;
              samples spent calling
              <a href='linalg.jl-2060a21cc9859cb6c0f5d0fc2550d46be9fcfaa7.html#L12'>&#43;</a>
              <br />
              55 &#40;8 &#37;&#41;
              samples spent calling
              <a href='Base.jl-b63de1b034843e706f34083efa09828330e9b63e.html#L49'>getproperty</a>
              <br />
            </div>
            <span class='code'>    r &#61; norm&#40;position&#41;</span>
          </td>
        </tr>
        <tr id='L224'>
          <td class='lineno'>224</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    theta &#61; acos&#40;position&#91;2&#93; / r&#41;</span>
          </td>
        </tr>
        <tr id='L225'>
          <td class='lineno'>225</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>863 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              443 &#40;51 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              369 &#40;43 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
              51 &#40;6 &#37;&#41;
              samples spent calling
              <a href='Base.jl-b63de1b034843e706f34083efa09828330e9b63e.html#L53'>setproperty&#33;</a>
              <br />
            </div>
            <span class='code'>    phi &#61; atan&#40;position&#91;3&#93;, position&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L226'>
          <td class='lineno'>226</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1234 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              603 &#40;49 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L113'>mod_angles&#33;</a>
              <br />
              439 &#40;36 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L112'>mod_angles&#33;</a>
              <br />
              192 &#40;16 &#37;&#41;
              samples spent calling
              <a href='Base.jl-b63de1b034843e706f34083efa09828330e9b63e.html#L53'>setproperty&#33;</a>
              <br />
            </div>
            <span class='code'>    return RealVector&#40;r, theta, phi&#41;</span>
          </td>
        </tr>
        <tr id='L227'>
          <td class='lineno'>227</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L228'>
          <td class='lineno'>228</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L229'>
          <td class='lineno'>229</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Color the disc based on radius and agnle</span>
          </td>
        </tr>
        <tr id='L230'>
          <td class='lineno'>230</td>
          <td class='tracecount excl'>487 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>487 &#40;1 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              26622 &#40;57 &#37;&#41;
              samples spent in schwarzschild_rhs
              <br />
              355 &#40;1 &#37;&#41; &#40;ex.&#41;,
              6683 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L200'>line 200</a>
              <br />
              417 &#40;2 &#37;&#41; &#40;ex.&#41;,
              6671 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L215'>line 215</a>
              <br />
              325 &#40;1 &#37;&#41; &#40;ex.&#41;,
              6607 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L210'>line 210</a>
              <br />
              379 &#40;1 &#37;&#41; &#40;ex.&#41;,
              6459 &#40;24 &#37;&#41; &#40;incl.&#41;
              when called from RK4_step&#33;
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L205'>line 205</a>
              <br />
              202 &#40;1 &#37;&#41; &#40;ex.&#41;,
              202 &#40;1 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L172'>line 172</a>
              <br />
            </div>
            
            <span class='code'>function disc_color&#40;r::Float64, phi::Float64, Rin::Float64, Rout::Float64&#41;::RGB</span>
          </td>
        </tr>
        <tr id='L231'>
          <td class='lineno'>231</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # normalize radius to &#91;0,1&#93;</span>
          </td>
        </tr>
        <tr id='L232'>
          <td class='lineno'>232</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    t &#61; clamp&#40;&#40;Rout - r&#41; / &#40;Rout - Rin&#41;, 0, 1&#41;</span>
          </td>
        </tr>
        <tr id='L233'>
          <td class='lineno'>233</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L234'>
          <td class='lineno'>234</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #--- base gradient: orange â†’ yellow â†’ white</span>
          </td>
        </tr>
        <tr id='L235'>
          <td class='lineno'>235</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    base &#61; &#40;</span>
          </td>
        </tr>
        <tr id='L236'>
          <td class='lineno'>236</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        &#40;1.0, 0.5, 0.1&#41;,   # orange at outer edge</span>
          </td>
        </tr>
        <tr id='L237'>
          <td class='lineno'>237</td>
          <td class='tracecount excl'>603 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>4923 &#40;11 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4238 &#40;98 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              81 &#40;2 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L29'>sin</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='int.jl-05fb6d1e84fb5a9da342ab6be058586e8665bbc6.html#L29'>sin</a>
              <br />
            </div>
            <span class='code'>        &#40;1.0, 0.9, 0.2&#41;,   # yellow</span>
          </td>
        </tr>
        <tr id='L238'>
          <td class='lineno'>238</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>302 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              302 &#40;100 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L56'>f</a>
              <br />
            </div>
            <span class='code'>        &#40;1.0, 1.0, 1.0&#41;    # white at inner edge</span>
          </td>
        </tr>
        <tr id='L239'>
          <td class='lineno'>239</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    &#41;</span>
          </td>
        </tr>
        <tr id='L240'>
          <td class='lineno'>240</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1482 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              678 &#40;46 &#37;&#41;
              samples spent calling
              <a href='intfuncs.jl-4c1e7347b74cbfc2f238f8a655363f60c54bc2d3.html#L370'>literal_pow</a>
              <br />
              273 &#40;18 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L491'>&#43;</a>
              <br />
              185 &#40;12 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L493'>*</a>
              <br />
              150 &#40;10 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>*</a>
              <br />
              108 &#40;7 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L494'>/</a>
              <br />
              88 &#40;6 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L492'>-</a>
              <br />
            </div>
            <span class='code'>   </span>
          </td>
        </tr>
        <tr id='L241'>
          <td class='lineno'>241</td>
          <td class='tracecount excl'>309 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>4810 &#40;10 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4300 &#40;96 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              127 &#40;3 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L98'>cos</a>
              <br />
              74 &#40;2 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>*</a>
              <br />
            </div>
            <span class='code'>    # simple 2-step linear blend</span>
          </td>
        </tr>
        <tr id='L242'>
          <td class='lineno'>242</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>14157 &#40;30 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12788 &#40;90 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L1135'>cot</a>
              <br />
              976 &#40;7 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>*</a>
              <br />
              393 &#40;3 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L492'>-</a>
              <br />
            </div>
            <span class='code'>    if t &lt; 0.5</span>
          </td>
        </tr>
        <tr id='L243'>
          <td class='lineno'>243</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>182 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              95 &#40;52 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>*</a>
              <br />
              85 &#40;47 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L493'>*</a>
              <br />
              2 &#40;1 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L494'>/</a>
              <br />
            </div>
            <span class='code'>        f &#61; 2t</span>
          </td>
        </tr>
        <tr id='L244'>
          <td class='lineno'>244</td>
          <td class='tracecount excl'>283 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>283 &#40;1 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        color &#61; &#40;</span>
          </td>
        </tr>
        <tr id='L245'>
          <td class='lineno'>245</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;1&#93;&#91;1&#93;*&#40;1-f&#41; &#43; base&#91;2&#93;&#91;1&#93;*f,</span>
          </td>
        </tr>
        <tr id='L246'>
          <td class='lineno'>246</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;1&#93;&#91;2&#93;*&#40;1-f&#41; &#43; base&#91;2&#93;&#91;2&#93;*f,</span>
          </td>
        </tr>
        <tr id='L247'>
          <td class='lineno'>247</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;1&#93;&#91;3&#93;*&#40;1-f&#41; &#43; base&#91;2&#93;&#91;3&#93;*f</span>
          </td>
        </tr>
        <tr id='L248'>
          <td class='lineno'>248</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        &#41;</span>
          </td>
        </tr>
        <tr id='L249'>
          <td class='lineno'>249</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L250'>
          <td class='lineno'>250</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        f &#61; 2&#40;t-0.5&#41;</span>
          </td>
        </tr>
        <tr id='L251'>
          <td class='lineno'>251</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        color &#61; &#40;</span>
          </td>
        </tr>
        <tr id='L252'>
          <td class='lineno'>252</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;2&#93;&#91;1&#93;*&#40;1-f&#41; &#43; base&#91;3&#93;&#91;1&#93;*f,</span>
          </td>
        </tr>
        <tr id='L253'>
          <td class='lineno'>253</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;2&#93;&#91;2&#93;*&#40;1-f&#41; &#43; base&#91;3&#93;&#91;2&#93;*f,</span>
          </td>
        </tr>
        <tr id='L254'>
          <td class='lineno'>254</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            base&#91;2&#93;&#91;3&#93;*&#40;1-f&#41; &#43; base&#91;3&#93;&#91;3&#93;*f</span>
          </td>
        </tr>
        <tr id='L255'>
          <td class='lineno'>255</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        &#41;</span>
          </td>
        </tr>
        <tr id='L256'>
          <td class='lineno'>256</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L257'>
          <td class='lineno'>257</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L258'>
          <td class='lineno'>258</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # --- radial noise: ring pattern</span>
          </td>
        </tr>
        <tr id='L259'>
          <td class='lineno'>259</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ring_pattern &#61; 0.85 &#43; 0.25*sin&#40;40r &#43; 5rand&#40;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L260'>
          <td class='lineno'>260</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    brightness &#61; t^1.3 * ring_pattern</span>
          </td>
        </tr>
        <tr id='L261'>
          <td class='lineno'>261</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L262'>
          <td class='lineno'>262</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # --- azimuthal streaks &#40;adds turbulence&#41;</span>
          </td>
        </tr>
        <tr id='L263'>
          <td class='lineno'>263</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    streaks &#61; 1.0 &#43; 0.1*sin&#40;50phi &#43; 7rand&#40;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L264'>
          <td class='lineno'>264</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    brightness *&#61; streaks</span>
          </td>
        </tr>
        <tr id='L265'>
          <td class='lineno'>265</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L266'>
          <td class='lineno'>266</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # clamp and apply brightness</span>
          </td>
        </tr>
        <tr id='L267'>
          <td class='lineno'>267</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    color &#61; RGB&#40;</span>
          </td>
        </tr>
        <tr id='L268'>
          <td class='lineno'>268</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        clamp&#40;color&#91;1&#93;*brightness, 0, 1&#41;,</span>
          </td>
        </tr>
        <tr id='L269'>
          <td class='lineno'>269</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        clamp&#40;color&#91;2&#93;*brightness, 0, 1&#41;,</span>
          </td>
        </tr>
        <tr id='L270'>
          <td class='lineno'>270</td>
          <td class='tracecount excl'>173 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>173 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              4855 &#40;10 &#37;&#41;
              samples spent in spherical_to_cartesian
              <br />
              508 &#40;10 &#37;&#41; &#40;ex.&#41;,
              4828 &#40;99 &#37;&#41; &#40;incl.&#41;
              when called from check_for_intersection
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L336'>line 336</a>
              <br />
              27 &#40;1 &#37;&#41; &#40;ex.&#41;,
              27 &#40;1 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L173'>line 173</a>
              <br />
            </div>
            
            <span class='code'>        clamp&#40;color&#91;3&#93;*brightness, 0, 1&#41;</span>
          </td>
        </tr>
        <tr id='L271'>
          <td class='lineno'>271</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    &#41;</span>
          </td>
        </tr>
        <tr id='L272'>
          <td class='lineno'>272</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L273'>
          <td class='lineno'>273</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return color</span>
          </td>
        </tr>
        <tr id='L274'>
          <td class='lineno'>274</td>
          <td class='tracecount excl'>228 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1535 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1295 &#40;99 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              12 &#40;1 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L29'>sin</a>
              <br />
            </div>
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L275'>
          <td class='lineno'>275</td>
          <td class='tracecount excl'>134 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>3147 &#40;7 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1687 &#40;56 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
              716 &#40;24 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              382 &#40;13 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5dc7f749ee81f9a1b69996e91008bb7712afdf35.html#L596'>*</a>
              <br />
              137 &#40;5 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L493'>*</a>
              <br />
              51 &#40;2 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L98'>cos</a>
              <br />
              40 &#40;1 &#37;&#41;
              samples spent calling
              <a href='float.jl-7170cf60e6d4e9b40a7dcd98416202990131c908.html#L29'>sin</a>
              <br />
            </div>
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L276'>
          <td class='lineno'>276</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L277'>
          <td class='lineno'>277</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function check_for_intersection&#40;ray::Ray&#41;</span>
          </td>
        </tr>
        <tr id='L278'>
          <td class='lineno'>278</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # TODO: we need to convert the ray back to cartesian coordinates before checking for collisions  </span>
          </td>
        </tr>
        <tr id='L279'>
          <td class='lineno'>279</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    position &#61; spherical_to_cartesian&#40;ray.position&#41;</span>
          </td>
        </tr>
        <tr id='L280'>
          <td class='lineno'>280</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #R &#61; norm&#40;position - sphere_position&#41;</span>
          </td>
        </tr>
        <tr id='L281'>
          <td class='lineno'>281</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    R2 &#61; norm2&#40;position - sphere_position&#41;</span>
          </td>
        </tr>
        <tr id='L282'>
          <td class='lineno'>282</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if R2 &lt; sphere_radius^2</span>
          </td>
        </tr>
        <tr id='L283'>
          <td class='lineno'>283</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # ray hit the sphere, we can stop it</span>
          </td>
        </tr>
        <tr id='L284'>
          <td class='lineno'>284</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        #ray.color &#61; RGB&#40;1, 1, 1&#41;</span>
          </td>
        </tr>
        <tr id='L285'>
          <td class='lineno'>285</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.color &#61; RGB&#40;0, 0, 0&#41;</span>
          </td>
        </tr>
        <tr id='L286'>
          <td class='lineno'>286</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.flag &#61; false</span>
          </td>
        </tr>
        <tr id='L287'>
          <td class='lineno'>287</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;&quot;spherical hit&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L288'>
          <td class='lineno'>288</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;position&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L289'>
          <td class='lineno'>289</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;ray.position&#41;</span>
          </td>
        </tr>
        <tr id='L290'>
          <td class='lineno'>290</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return </span>
          </td>
        </tr>
        <tr id='L291'>
          <td class='lineno'>291</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L292'>
          <td class='lineno'>292</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    R_second2 &#61; norm2&#40;position - second_sphere_position &#41;</span>
          </td>
        </tr>
        <tr id='L293'>
          <td class='lineno'>293</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if R_second2 &lt; second_sphere_radius^2</span>
          </td>
        </tr>
        <tr id='L294'>
          <td class='lineno'>294</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.color &#61; RGB&#40;1, 0, 0&#41; </span>
          </td>
        </tr>
        <tr id='L295'>
          <td class='lineno'>295</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.flag &#61; false</span>
          </td>
        </tr>
        <tr id='L296'>
          <td class='lineno'>296</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;&quot;spherical hit&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L297'>
          <td class='lineno'>297</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;position&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L298'>
          <td class='lineno'>298</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;ray.position&#41;</span>
          </td>
        </tr>
        <tr id='L299'>
          <td class='lineno'>299</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return </span>
          </td>
        </tr>
        <tr id='L300'>
          <td class='lineno'>300</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L301'>
          <td class='lineno'>301</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    R_third2 &#61; norm2&#40;position - third_sphere_position&#41;</span>
          </td>
        </tr>
        <tr id='L302'>
          <td class='lineno'>302</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if R_third2 &lt; third_sphere_radius^2</span>
          </td>
        </tr>
        <tr id='L303'>
          <td class='lineno'>303</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ray.color &#61; RGB&#40;0, 1, 0&#41; </span>
          </td>
        </tr>
        <tr id='L304'>
          <td class='lineno'>304</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;&quot;spherical hit&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L305'>
          <td class='lineno'>305</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;position&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L306'>
          <td class='lineno'>306</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # println&#40;ray.position&#41;</span>
          </td>
        </tr>
        <tr id='L307'>
          <td class='lineno'>307</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # ray.flag &#61; false</span>
          </td>
        </tr>
        <tr id='L308'>
          <td class='lineno'>308</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return</span>
          </td>
        </tr>
        <tr id='L309'>
          <td class='lineno'>309</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L310'>
          <td class='lineno'>310</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if abs&#40;position&#91;2&#93;&#41; &lt; 5e-3  </span>
          </td>
        </tr>
        <tr id='L311'>
          <td class='lineno'>311</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        rho &#61; position&#91;1&#93;^2 &#43; position&#91;3&#93;^2 </span>
          </td>
        </tr>
        <tr id='L312'>
          <td class='lineno'>312</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if Rin^2 &lt;&#61; rho &lt;&#61; Rout^2</span>
          </td>
        </tr>
        <tr id='L313'>
          <td class='lineno'>313</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            #ray.color &#61; RGB&#40;sqrt&#40;rho&#41; / Rout, sqrt&#40;rho&#41; / Rout, sqrt&#40;rho&#41; / Rout&#41;</span>
          </td>
        </tr>
        <tr id='L314'>
          <td class='lineno'>314</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            ray.color &#61; disc_color&#40;ray.position&#91;1&#93;, ray.position&#91;2&#93;, Rin, Rout&#41;</span>
          </td>
        </tr>
        <tr id='L315'>
          <td class='lineno'>315</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            ray.flag &#61; false</span>
          </td>
        </tr>
        <tr id='L316'>
          <td class='lineno'>316</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # println&#40;&quot;disc hit&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L317'>
          <td class='lineno'>317</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # println&#40;position&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L318'>
          <td class='lineno'>318</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # println&#40;ray.position&#41;</span>
          </td>
        </tr>
        <tr id='L319'>
          <td class='lineno'>319</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            return</span>
          </td>
        </tr>
        <tr id='L320'>
          <td class='lineno'>320</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end          </span>
          </td>
        </tr>
        <tr id='L321'>
          <td class='lineno'>321</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L322'>
          <td class='lineno'>322</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L323'>
          <td class='lineno'>323</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L324'>
          <td class='lineno'>324</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L325'>
          <td class='lineno'>325</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L326'>
          <td class='lineno'>326</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function main&#40;&#41;</span>
          </td>
        </tr>
        <tr id='L327'>
          <td class='lineno'>327</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # rays &#61; make_system&#40;W, H&#41;</span>
          </td>
        </tr>
        <tr id='L328'>
          <td class='lineno'>328</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    rays &#61; Vector&#123;Ray&#125;&#40;undef, W*H&#41;</span>
          </td>
        </tr>
        <tr id='L329'>
          <td class='lineno'>329</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    rays_curved &#61; make_system&#33;&#40;rays, W, H&#41;</span>
          </td>
        </tr>
        <tr id='L330'>
          <td class='lineno'>330</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Move the rays</span>
          </td>
        </tr>
        <tr id='L331'>
          <td class='lineno'>331</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    image_curved &#61; render&#40;rays_curved, 100.0, 0.01&#41;</span>
          </td>
        </tr>
        <tr id='L332'>
          <td class='lineno'>332</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Save the image</span>
          </td>
        </tr>
        <tr id='L333'>
          <td class='lineno'>333</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    save&#40;&quot;sphere_test_curved_ray_casting2.png&quot;, image_curved&#41;</span>
          </td>
        </tr>
        <tr id='L334'>
          <td class='lineno'>334</td>
          <td class='tracecount excl'>71 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>71 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              6706 &#40;14 &#37;&#41;
              samples spent in check_for_intersection
              <br />
              470 &#40;7 &#37;&#41; &#40;ex.&#41;,
              6680 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L173'>line 173</a>
              <br />
              26 &#40;0 &#37;&#41; &#40;ex.&#41;,
              26 &#40;0 &#37;&#41; &#40;incl.&#41;
              when called from #38#threadsfor_fun
              <a href='threadingconstructs.jl-be65946e359bb76596da77e48f0bf89571986361.html#L219'>line 219</a>
              <br />
            </div>
            
            <span class='code'>    println&#40;&quot;Saved sphere_test.png&quot;&#41;</span>
          </td>
        </tr>
        <tr id='L335'>
          <td class='lineno'>335</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L336'>
          <td class='lineno'>336</td>
          <td class='tracecount excl'>33 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>5032 &#40;11 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4828 &#40;97 &#37;&#41;
              samples spent calling
              <a href='interstellar2.jl-38f7cc00682e152cf486c344084612d0adfc37d2.html#L270'>spherical_to_cartesian</a>
              <br />
              77 &#40;2 &#37;&#41;
              samples spent calling
              <a href='Base.jl-b63de1b034843e706f34083efa09828330e9b63e.html#L49'>getproperty</a>
              <br />
              56 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L29'>sin</a>
              <br />
              38 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-dda7f67342c15340cfb39e4413ef3ddf2260b2b1.html#L98'>cos</a>
              <br />
            </div>
            <span class='code'></span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

